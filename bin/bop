#!/usr/bin/env zsh

# research
# /* set -e */
# /* set -E */
# /* set -T */
# /* set +e */
# /* set +E */
# /* set +T */
#
function version {
  echo "1"
}

function help {
  echo "printing help here"
}

#
# Arg parsing taken from
# https://github.com/sstephenson/bats/blob/master/libexec/bats
#
options=()
arguments=()

for arg in "$@"; do
  if [ "${arg:0:1}" = "-" ]; then
    if [ "${arg:1:1}" = "-" ]; then
      options[${#options[*]}]="${arg:2}"
    else
      index=1
      while option="${arg:$index:1}"; do
        [ -n "$option" ] || break
        options[${#options[*]}]="$option"
        let index+=1
      done
    fi
  else
    arguments[${#arguments[*]}]="$arg"
  fi
done

for option in "${options[@]}"; do
  case "$option" in
  "h" | "help" )
    help
    exit 0
    ;;
  "v" | "version" )
    version
    exit 0
    ;;
  "t" | "tap" )
    BOP_REPORTER="tap"
    ;;
  "f" | "formatter" )
    BOP_REPORTER="simple"
    ;;
  * )
    help >&2
    exit 1
    ;;
  esac
done

echo "$arguments"
echo "$options"
